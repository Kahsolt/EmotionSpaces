### Challenge

- 现存模型过拟合
- VA这种连续空间难以理解


### Model

> hparam: E=100, B=32, lr=2e-5

#### baseline

| Accuracy (train/valid) | ResNet50 | ResNet101 | MobileNet_V2 | ViT_B_16 | ViT_B_32 |
| :-: | :-: | :-: | :-: | :-: | :-: |
| Emo6Dim6 | 97.95%/45.72%  | 97.21%/45.54% | 92.05%/47.17% | 98.26%/49.93%  | 98.26%/44.80%  |
| Emo6Dim7 | 97.00%/39.00%  | 98.56%/42.24% | 89.75%/45.56% | 99.61%43.80%   | 98.04%/40.42%  |
| Emo6VA   | 0.188/1.135    | 0.17/1.12     | 0.2081/0.7786 | 0.03781/0.6638 | 0.04957/0.7252 |
| Abstract | 98.74%/18.40%  | 99.57%/14.57% | 92.46%/18.71% | 98.78%/15.00%  | 99.73%/19.04%  |
| Artphoto | 97.83%/38.89%  | 98.68%/35.77% | 96.13%/29.65% | 99.34%/38.26%  | 97.52%/28.55%  |
| OASIS    | 0.07928/0.4739 | 0.5141/0.4202 | 0.179/0.5316  | 0.02315/0.4182 | 0.07642/0.6762 |
| TwitterI | 98.71%/83.00%  | 98.74%/82.76% | 97.6%/80.16%  | 98.58%/82.55%  | 99.16%/79.06%  |
| EmoSet   | 89.79%/76.74%  | 82.18%/77.42% | 76.10%/74.93% | 92.06%/78.20%  | 83.55%/74.64%  |

> 别人论文或者项目代码里抄的

| Accuracy | xxx | xxx | xxx | xxx | xxx |
| :-: | :-: | :-: | :-: | :-: | :-: |
| xxx |  |  |  |  |  |  |

#### ours

head_type: Polar, VA. Ekman, EkmanN, Mikels
head_name: 9 heads

⚪ Head=linear (数值精度可能低一些，但可以看出相关性)

> run vis.py => img/tx/*.png 可视化权重矩阵/相关性
> run vis_gui.py => 交互式可视化

| Accuracy | M-ResNet50 | M-MobileNet_V2 | M-ViT_B_16 |
| :-: | :-: | :-: | :-: |
| Emo6Dim6 | 54.72%/48.36% |  |  |
| Emo6Dim7 | 50.79%/41.91% |  |  |
| Emo6VA   | 0.5276/0.6186 |  |  |
| TwitterI | 90.26%/83.62% |  |  |
| EmoSet   | 75.16%/67.01% |  |  |

⚪ Head=mlp (数值精度可能高一些，但无法透视相关性)

> run vis_gui.py => 交互式可视化

| Accuracy | M-ResNet50 | M-MobileNet_V2 | M-ViT_B_16 |
| :-: | :-: | :-: | :-: |
| Emo6Dim6 | 57.13%/45.96% |  |  |
| Emo6Dim7 | 52.33%/43.35% |  |  |
| Emo6VA   | 0.4911/0.6186 |  |  |
| TwitterI | 92.45%/84.70% |  |  |
| EmoSet   | 75.39%/72.46% |  |  |


### Analysis

- 多任务模型 (9 datasets, 3/5 model archs, 2 head types)
  - 精度是否更好，最好略好
  - 有没有减缓过拟合
  - 在精度不下降太多的情况下，一定程度上节省了参数
  - LDL六种度量
- 空间转换
  - 可视化权重矩阵/相关性: `run vis.py => img/tx/*.png`
  - 交互式可视化: `run vis_gui.py`
